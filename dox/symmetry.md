Molecular Symmetry in Pulsar                                         {#symmetry}
============================

Although the majority of molecules do not have spatial symmetry for the ones
that do, exploiting it can lead to massive speed-ups.  The purpose of this page
is to provide the relevant background regarding symmetry and to explain how it
is handleded in Pulsar.

## Theoretical Background

### Group Theory

Group theory is the study of the mathematical objects known as groups.  Groups
are defined as:

- A set of elements, \f$G\f$
- and an operation, \f$\oplus\f$, satisfying:
  - Closure: \f$\forall x_i,x_j\in G\ \exists\ x_k\in G\ :\ x_i\oplus x_j=x_k\f$
  - Associativity: \f$\forall x_i,x_j,x_k\in G\f$,
       \f$x_i\oplus (x_j\oplus x_k)=(x_i\oplus x_j)\oplus x_k\f$
  - Identity: \f$\forall x_i\in G\ \exists\ 1\in G\ :\ x_i\oplus 1=1\oplus x_i=x_i\f$
  - Invertabilty: \f$\forall x_i\in G\ \exists\ x_i^{-1}\ :\ x_i\oplus x_i^{-1}=x_i^{-1}\oplus x_i=1\f$

As a slight aside:
  - Magma is a set of elements and an operation satisfying closure
  - Semigroup is a magma whose operation additionally satisfies associativity
  - Monoid is a semigroup whose operation satisfies identity

thus a group is a monoid with invertability.  Hence many of the results of group
theory are already known from studying the results of their substructures.

Anyways, the relevant fact for our purposes is that the set of symmetry
operations possessed by an object forms a group with the operation being
multiplication.  This means we can immediatly reusue the results of group theory
without having to rederive them.

### Cosets

The description below relies on the idea of cosets quite a bit so it's worth
listing their properties here for reference.

Let \f$\mathcal{G}\f$ be a group, \f$\mathcal{H}\f$ be a subgroup of
\f$\mathcal{G}\f$ and \f$g\f$ be an element of \f$\mathcal{G}\f$.  Then the
left coset of \f$\mathcal{H}\f$ in \f$\mathcal{G}\f$ with respect to \f$g\f$ is
the subset of \f$\mathcal{G}\f$ generated by \f$g\mathcal{H}\f$, similarly, the
right coset of \f$\mathcal{H}\f$ in \f$\mathcal{G}\f$ with respect to \f$g\f$ is
\f$\mathcal{H}g\f$.  Because elements of a group need not commute the left coset
need not equal the right coset, also cosets are in general not groups, but only
subsets.  Now note:

- \f$g\mathcal{H}=\left(g\mathcal{H}g\right)g^{-1}\f$
- \f$\mathcal{H}g=g\left(g^{-1}\mathcal{H}g\right)\f$

Respectively, this shows us that the left (right) coset of \f$\mathcal{H}\f$ in
\f$\mathcal{G}\f$ with respect to \f$g\f$ is equivelent to the right (left)
coset of another conjugate group.  Given that conjugancy is an equivelence
relation (*i.e* each element of \f$\mathcal{G}\f$ belongs to one and only one
conjugate group), we see that there is a bijective mapping
between the left and right cosets of a subgroup and we conclude that the number
of left cosets must equal the number of right cosets; that number is termed the
index of the subgroup.  The conjugancy point also tells us that cosets are
disjoint (*i.e* no element of \f$\mathcal{G}\f$ belongs to two cosets) hence
the cosets form a partioning of \f$\mathcal{G}\f$ into \f$\mathcal{H}\f$ and a
series of other sets.

## Symmetry Orbitals

For the time being we don't actually need to define the symmetry operations, but
can work abstractly.  This presentation follows Davidson. **JCP** (1975) 400.
Anyways, assume that our molecular system has been found to be symmetric under
a point group \f$\mathcal{G}\f$.  We assume that the order (the number of
elements in the set) is \f$g\f$.  The \f$i\f$-th element of \f$\mathcal{G}\f$ is
denoted \f$G_i\f$ and is one of the symmetry operations (somewhat confusingly it
is not a symmetry element...).  One of the \f$g\f$ operations is always identity
and we denote it with \f$E\f$.  We use the standard notation of denoting the
matrix representation of \f$G_i\f$ as \f$D(G_i)\f$.

If we assume that we are only considering atom centered basis sets, then each
atomic orbital (AO) can be associated with a particular atom.  Let us assume
that \f$\phi_{\mu I}\f$ is the \f$\mu\f$-th AO on atom \f$I\f$.  For every atom
there must be a subgroup of \f$\mathcal{G}\f$ of symmetry operations that leave
that atom unchanged.  Denoting that subgroup \f$\mathcal{U}\f$  we know that:
\f[
U_i\phi_{\mu I}=\sum_{\nu}C_{\mu\nu I}(U_i)\phi_{\nu I}
\f]
that is the result of a symmetry operation \f$U_i\f$ from \f$\mathcal{U}\f$ on
an AO is a linear combination of the AOs on that atom.  Conversley, if \f$G_i\f$
is a symmetry operation not in \f$\mathcal{U}\f$ then we know:
\f[
G_i\phi_{\mu I}=\sum_{\nu}C_{\mu\nu G_i(I)}(G_i)\phi_{\nu G_i(I)}
\f]
where \f$G_i(I)\f$ is the atom that \f$G_i\f$ turns \f$I\f$ into.  Application
of \f$G_i\f$ to each element in \f$\mathcal{U}\f$ results in a set of symmetry
operations that we denote \f$G_i\mathcal{U}\f$, *i.e* the left coset of
\f$\mathcal{U}\f$ in \f$\mathcal{G}\f$ with respect to \f$G_i\f$.

We now define a series of operators for the \f$\mu\f$-th irreducible
representation of \f$\mathcal{G}\f$ as:
\f$\widehat{P}^{\mu}=\frac{n_\mu}{g}\sum_{i=1}^{g}D^\mu(G_i)^{*}G_i\f$.  Because
the various \f$G_i\f$ are nothing more than rotations combined possibly with
inversion it follows that \f$D^\mu_{ij}(G_k)=D^\mu_{ji}(G^{-1}_k)^*\f$, *i.e.*
that the matrices are unitary.  Consequentially:
\f[
\widehat{P}^{\mu}_{ij}=\frac{n_\mu}{g}\sum_{k=1}^{g}D^\mu(G_k)^{*}_{ij}G_k
 =\frac{n_\mu}{g}\sum_{k=1}^{g}D^\mu(G_k^{-1})_{ji}\left(G_k^{-1}\right)^\dagger
 =\left(\widehat{P}^{\mu}_{ji}\right)^\dagger
\f]
